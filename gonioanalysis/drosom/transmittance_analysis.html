<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.1">
<title>gonioanalysis.drosom.transmittance_analysis API documentation</title>
<meta name="description" content="">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>gonioanalysis.drosom.transmittance_analysis</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="gonioanalysis.drosom.transmittance_analysis.RelativeTAnalyser"><code class="flex name class">
<span>class <span class="ident">RelativeTAnalyser</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Transmittance analysis but report relative changes.</p>
<p>Changes are relative to the 1st frame photon count of each repeat (the
1st frame photon count is corrected to be the mean of 2nd and 3rd frames).</p>
<p>Uses TAnalyser measurements and vice versa so measuring either with
TAnalyser or RelativeTAnalyser makes both measured.</p>
<p>Initialize the MAnalyser object.</p>
<h2 id="arguments">Arguments</h2>
<dl>
<dt><strong><code>no_data_load</code></strong> :&ensp;<code>bool</code></dt>
<dd>If True, skips loading data at constructing the object (use if
needing many short lived objects.</dd>
<dt><strong><code>active_analysis</code></strong> :&ensp;<code>string</code></dt>
<dd>Name of the activated analysis</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class RelativeTAnalyser(TAnalyser):
    &#39;&#39;&#39;Transmittance analysis but report relative changes.

    Changes are relative to the 1st frame photon count of each repeat (the
    1st frame photon count is corrected to be the mean of 2nd and 3rd frames).
    
    Uses TAnalyser measurements and vice versa so measuring either with
    TAnalyser or RelativeTAnalyser makes both measured.
    &#39;&#39;&#39;

    def load_analysed_movements(self, *args, **kwargs):
        super().load_analysed_movements(*args, **kwargs)

        for eye in self.movements:
            for image_folder, data in self.movements[eye].items():

                for i_repeat in range(len(data)):
                    for key in [&#39;x&#39;, &#39;y&#39;]:
                        start_val = np.mean((data[i_repeat][key][1], data[i_repeat][key][2]))
                        data[i_repeat][key][0] = start_val
                        if start_val == 0:
                            continue

                        # Add on top of a big number (1000) so that negative
                        # changes won&#39;t die in the squaring when getting mag
                        # traces.
                        data[i_repeat][key] = 1000+(
                                (np.array(data[i_repeat][key]) - start_val) / start_val)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser" href="#gonioanalysis.drosom.transmittance_analysis.TAnalyser">TAnalyser</a></li>
<li><a title="gonioanalysis.drosom.analysing.MAnalyser" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser">MAnalyser</a></li>
<li><a title="gonioanalysis.drosom.analysing.AnalyserBase" href="analysing.html#gonioanalysis.drosom.analysing.AnalyserBase">AnalyserBase</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="gonioanalysis.drosom.transmittance_analysis.RelativeTAnalyser.load_analysed_movements"><code class="name flex">
<span>def <span class="ident">load_analysed_movements</span></span>(<span>self, *args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser" href="#gonioanalysis.drosom.transmittance_analysis.TAnalyser">TAnalyser</a></b></code>:
<ul class="hlist">
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.are_rois_selected" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.are_rois_selected">are_rois_selected</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.count_roi_selected_folders" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.count_roi_selected_folders">count_roi_selected_folders</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.folder_has_movements" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.folder_has_movements">folder_has_movements</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.folder_has_rois" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.folder_has_rois">folder_has_rois</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.get_2d_vectors" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_2d_vectors">get_2d_vectors</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.get_3d_vectors" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_3d_vectors">get_3d_vectors</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.get_antenna_level_correction" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_antenna_level_correction">get_antenna_level_correction</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.get_displacements_from_folder" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_displacements_from_folder">get_displacements_from_folder</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.get_horizontal_vertical" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_horizontal_vertical">get_horizontal_vertical</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.get_imagefolder" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_imagefolder">get_imagefolder</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.get_imaging_frequency" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_imaging_frequency">get_imaging_frequency</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.get_imaging_parameters" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_imaging_parameters">get_imaging_parameters</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.get_magnitude_traces" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_magnitude_traces">get_magnitude_traces</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.get_moving_ROIs" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_moving_ROIs">get_moving_ROIs</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.get_pixel_size" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_pixel_size">get_pixel_size</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.get_raw_xy_traces" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_raw_xy_traces">get_raw_xy_traces</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.get_recording_time" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_recording_time">get_recording_time</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.get_rotstep_size" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_rotstep_size">get_rotstep_size</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.get_snap_fn" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_snap_fn">get_snap_fn</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.get_specimen_age" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_specimen_age">get_specimen_age</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.get_specimen_name" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_specimen_name">get_specimen_name</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.get_specimen_sex" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_specimen_sex">get_specimen_sex</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.get_time_ordered" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_time_ordered">get_time_ordered</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.get_ui_options" href="analysing.html#gonioanalysis.drosom.analysing.AnalyserBase.get_ui_options">get_ui_options</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.is_measured" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.is_measured">is_measured</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.link_data" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.link_data">link_data</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.list_analyses" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.list_analyses">list_analyses</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.list_imagefolders" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.list_imagefolders">list_imagefolders</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.list_images" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.list_images">list_images</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.list_rotations" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.list_rotations">list_rotations</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.load_ROIs" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.load_ROIs">load_ROIs</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.load_linked_data" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.load_linked_data">load_linked_data</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.mark_bad" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.mark_bad">mark_bad</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.measure_both_eyes" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.measure_both_eyes">measure_both_eyes</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.measure_movement" href="#gonioanalysis.drosom.transmittance_analysis.TAnalyser.measure_movement">measure_movement</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.save_linked_data" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.save_linked_data">save_linked_data</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.select_ROIs" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.select_ROIs">select_ROIs</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.set_angle_limits" href="analysing.html#gonioanalysis.drosom.analysing.AnalyserBase.set_angle_limits">set_angle_limits</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.stop" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.stop">stop</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="gonioanalysis.drosom.transmittance_analysis.TAnalyser"><code class="flex name class">
<span>class <span class="ident">TAnalyser</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Transmittance analyser.</p>
<p>Analyses the ROI's light throughput while the ROI tracks
its moving feature (ie. using MAnalyser motion analysis results)</p>
<p>Mean (average) pixel value of the ROI is quantified.</p>
<p>Initialize the MAnalyser object.</p>
<h2 id="arguments">Arguments</h2>
<dl>
<dt><strong><code>no_data_load</code></strong> :&ensp;<code>bool</code></dt>
<dd>If True, skips loading data at constructing the object (use if
needing many short lived objects.</dd>
<dt><strong><code>active_analysis</code></strong> :&ensp;<code>string</code></dt>
<dd>Name of the activated analysis</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class TAnalyser(MAnalyser):
    &#39;&#39;&#39;
    Transmittance analyser.

    Analyses the ROI&#39;s light throughput while the ROI tracks
    its moving feature (ie. using MAnalyser motion analysis results)
    
    Mean (average) pixel value of the ROI is quantified.
    &#39;&#39;&#39;

    def __init__(self, *args, **kwargs):

        super().__init__(*args, **kwargs)
        
        self._real_movements_savefn = self._movements_savefn

        self._movements_skelefn = self._movements_skelefn.replace(&#39;movements_&#39;, &#39;transmittance_&#39;)
        self.active_analysis = &#39;&#39;


    def measure_movement(self, eye, *args, **kwargs):
        &#39;&#39;&#39;
        Analyse transmittance/brightness by calculating mean (average)
        pixel value of the ROI in its time locations, and save results.
        &#39;&#39;&#39;
        self.movements = {}
        
        intensities = {}

        manalyser = MAnalyser(self.data_path, self.folder)
        manalyser.active_analysis = self.active_analysis

        for i, angle in enumerate(self.stacks):
            print(&#39;  Image folder {}/{}&#39;.format(i+1, len(self.stacks)))
            
            roi = self.ROIs[eye].get(angle, None)

            if roi is not None:
                
                images = self.stacks[angle]
                
                intensities[angle] = []

                for i_repeat, repeat in enumerate(images):
                    ints = []
                    
                    try:
                        _roi = manalyser.get_moving_ROIs(eye, angle, i_repeat)
                    except AttributeError:
                        _roi = None
                    
                    i_frame = 0

                    for fn in repeat:
                        
                        tiff = tifffile.TiffFile(fn)
                        
                        for i_page in range(len(tiff.pages)):
                            
                            images = tiff.asarray(key=i_page)
                            if len(images.shape) == 2:
                                images = [images]
                            
                            for image in images:
                                if _roi is None:
                                    x,y,w,h = roi
                                else:
                                    try:
                                        x,y,w,h = [int(round(z)) for z in _roi[i_frame]]
                                    except IndexError:
                                        # No ROI movement, skip
                                        break
                                
                                intensity = np.mean(image[y:y+h,x:x+w])
                                ints.append(intensity)
                                
                                i_frame += 1
                                print(&#34;fn {}: {}/{}&#34;.format(os.path.basename(fn), i_frame+1, len(tiff.pages)))

                    # X component carries the brightness change information
                    # Y component is set to zero for compability (in future
                    #   remove to save disk?)
                    intensities[angle].append({&#39;x&#39;: ints, &#39;y&#39;:[0]*len(ints)})


        self.movements[eye] = intensities

        # Save movements
        with open(self._movements_savefn.format(eye), &#39;w&#39;) as fp:
            json.dump(intensities, fp)

    

    def is_measured(self):
        fns = [self._movements_savefn.format(eye) for eye in self.eyes]
        return all([os.path.exists(fn) for fn in fns])


    def load_analysed_movements(self, *args, **kwargs):
        super().load_analysed_movements(*args, **kwargs)

        # Nullify the Y component so that X carries the brightness change data.
        # Otherwise, at get_magnitude traces, when calculating displacement
        # distance, the data gets multiplied by sqrt(2).
        #
        # The same change is done in TAnalyser.measure_movement but this also
        # fixes previously analysed data without reanalysing.
        for eye in self.movements:
            for image_folder, data in self.movements[eye].items():
                for i_repeat in range(len(data)):
                    data[i_repeat][&#39;y&#39;] = np.zeros(len(data[i_repeat][&#39;x&#39;]))


    # Here the original MAnalyser method modified so that the presentation
    # makes more sense with light transmittance analysis 
    #
    # 1) The first data point is often &#34;polluted&#34; because the stimulus LED
    #   goes on within the first frame of imaging (thus first frame darker)
    #   -&gt; bring the 1st to the mean of 2nd and 3rd
    # 2) Shift the trace in Y to always start from zero
    #
    def get_magnitude_traces(self, *args, **kwargs):
        
        magnitude_traces = super().get_magnitude_traces(*args, **kwargs)

        for image_folder in magnitude_traces:

            # 1) &#34;Recompute&#34; the first data point
            for trace in magnitude_traces[image_folder]:
                trace[0] = np.mean((trace[1], trace[2]))

            # 2) Shift whole trace
            magnitude_traces[image_folder] = np.array([t-t[0] for t in magnitude_traces[image_folder]])

        return magnitude_traces</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="gonioanalysis.drosom.analysing.MAnalyser" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser">MAnalyser</a></li>
<li><a title="gonioanalysis.drosom.analysing.AnalyserBase" href="analysing.html#gonioanalysis.drosom.analysing.AnalyserBase">AnalyserBase</a></li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="gonioanalysis.drosom.transmittance_analysis.RelativeTAnalyser" href="#gonioanalysis.drosom.transmittance_analysis.RelativeTAnalyser">RelativeTAnalyser</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="gonioanalysis.drosom.transmittance_analysis.TAnalyser.load_analysed_movements"><code class="name flex">
<span>def <span class="ident">load_analysed_movements</span></span>(<span>self, *args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="gonioanalysis.drosom.transmittance_analysis.TAnalyser.measure_movement"><code class="name flex">
<span>def <span class="ident">measure_movement</span></span>(<span>self, eye, *args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Analyse transmittance/brightness by calculating mean (average)
pixel value of the ROI in its time locations, and save results.</p></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="gonioanalysis.drosom.analysing.MAnalyser" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser">MAnalyser</a></b></code>:
<ul class="hlist">
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.are_rois_selected" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.are_rois_selected">are_rois_selected</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.count_roi_selected_folders" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.count_roi_selected_folders">count_roi_selected_folders</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.folder_has_movements" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.folder_has_movements">folder_has_movements</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.folder_has_rois" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.folder_has_rois">folder_has_rois</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.get_2d_vectors" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_2d_vectors">get_2d_vectors</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.get_3d_vectors" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_3d_vectors">get_3d_vectors</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.get_antenna_level_correction" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_antenna_level_correction">get_antenna_level_correction</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.get_displacements_from_folder" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_displacements_from_folder">get_displacements_from_folder</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.get_horizontal_vertical" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_horizontal_vertical">get_horizontal_vertical</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.get_imagefolder" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_imagefolder">get_imagefolder</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.get_imaging_frequency" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_imaging_frequency">get_imaging_frequency</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.get_imaging_parameters" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_imaging_parameters">get_imaging_parameters</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.get_magnitude_traces" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_magnitude_traces">get_magnitude_traces</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.get_moving_ROIs" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_moving_ROIs">get_moving_ROIs</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.get_pixel_size" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_pixel_size">get_pixel_size</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.get_raw_xy_traces" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_raw_xy_traces">get_raw_xy_traces</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.get_recording_time" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_recording_time">get_recording_time</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.get_rotstep_size" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_rotstep_size">get_rotstep_size</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.get_snap_fn" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_snap_fn">get_snap_fn</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.get_specimen_age" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_specimen_age">get_specimen_age</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.get_specimen_name" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_specimen_name">get_specimen_name</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.get_specimen_sex" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_specimen_sex">get_specimen_sex</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.get_time_ordered" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.get_time_ordered">get_time_ordered</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.get_ui_options" href="analysing.html#gonioanalysis.drosom.analysing.AnalyserBase.get_ui_options">get_ui_options</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.is_measured" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.is_measured">is_measured</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.link_data" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.link_data">link_data</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.list_analyses" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.list_analyses">list_analyses</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.list_imagefolders" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.list_imagefolders">list_imagefolders</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.list_images" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.list_images">list_images</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.list_rotations" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.list_rotations">list_rotations</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.load_ROIs" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.load_ROIs">load_ROIs</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.load_linked_data" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.load_linked_data">load_linked_data</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.mark_bad" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.mark_bad">mark_bad</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.measure_both_eyes" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.measure_both_eyes">measure_both_eyes</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.save_linked_data" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.save_linked_data">save_linked_data</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.select_ROIs" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.select_ROIs">select_ROIs</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.set_angle_limits" href="analysing.html#gonioanalysis.drosom.analysing.AnalyserBase.set_angle_limits">set_angle_limits</a></code></li>
<li><code><a title="gonioanalysis.drosom.analysing.MAnalyser.stop" href="analysing.html#gonioanalysis.drosom.analysing.MAnalyser.stop">stop</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<a href='../index.html'><- Back to All Docs</a><br>
<a href="javascript:history.back()"><- Back one page</a>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="gonioanalysis.drosom" href="index.html">gonioanalysis.drosom</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="gonioanalysis.drosom.transmittance_analysis.RelativeTAnalyser" href="#gonioanalysis.drosom.transmittance_analysis.RelativeTAnalyser">RelativeTAnalyser</a></code></h4>
<ul class="">
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.RelativeTAnalyser.load_analysed_movements" href="#gonioanalysis.drosom.transmittance_analysis.RelativeTAnalyser.load_analysed_movements">load_analysed_movements</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser" href="#gonioanalysis.drosom.transmittance_analysis.TAnalyser">TAnalyser</a></code></h4>
<ul class="">
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.load_analysed_movements" href="#gonioanalysis.drosom.transmittance_analysis.TAnalyser.load_analysed_movements">load_analysed_movements</a></code></li>
<li><code><a title="gonioanalysis.drosom.transmittance_analysis.TAnalyser.measure_movement" href="#gonioanalysis.drosom.transmittance_analysis.TAnalyser.measure_movement">measure_movement</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.1</a>.</p>
</footer>
</body>
</html>
