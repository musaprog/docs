<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.1">
<title>gonioanalysis.droso API documentation</title>
<meta name="description" content="General methods common for both DrosoM and DrosoX.">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>gonioanalysis.droso</code></h1>
</header>
<section id="section-intro">
<p>General methods common for both DrosoM and DrosoX.</p>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="gonioanalysis.droso.simple_select"><code class="name flex">
<span>def <span class="ident">simple_select</span></span>(<span>list_of_strings)</span>
</code></dt>
<dd>
<div class="desc"><p>Simple command line user interface for selecting a string
from a list of many strings.</p>
<p>Returns the string selected.</p></div>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="gonioanalysis.droso.DrosoSelect"><code class="flex name class">
<span>class <span class="ident">DrosoSelect</span></span>
<span>(</span><span>datadir=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Selecting a Droso folder based on user input or programmatically.</p>
<p>Folder has to start with "Droso".</p>
<p>TODO:
- add programmatic selection methods of folders</p>
<p>datadir
Where the different droso folder are in</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class DrosoSelect:
    &#39;&#39;&#39;
    Selecting a Droso folder based on user input or programmatically.

    Folder has to start with &#34;Droso&#34;.

    TODO:
    - add programmatic selection methods of folders
    &#39;&#39;&#39;

    def __init__(self, datadir=None):
        &#39;&#39;&#39;
        datadir     Where the different droso folder are in
        &#39;&#39;&#39;
        if datadir is None:
            self.path = input(&#34;Input data directory &gt;&gt; &#34;)
        else:
            self.path = datadir

        folders = [fn for fn in os.listdir(self.path) if isdir(join(self.path, fn))]
        self.folders = [os.path.join(self.path, fn) for fn in folders]
 
        self.groups = SpecimenGroups()
    

    def parse_specimens(self, user_input):
        &#39;&#39;&#39;
        Parse user input to get manalyser names.

        Arguments
        ---------
        *user_input : string
            Comma separated list of specimen names or indices of self.folders,
            or a group name.
        
        Raises ValueError if unable to parse.
        &#39;&#39;&#39;
        
        # 1) If user supplies a specimen group name
        if user_input in self.groups.get_groups().keys():
            user_input = &#39;,&#39;.join(self.groups.get_specimens(user_input))

            sel_keys = [os.path.basename(x) for x in user_input.split(&#39;,&#39;)]
            selections = [folder for folder in self.folders if os.path.basename(folder) in sel_keys]
            
            if len(selections) == len(sel_keys):
                print(&#39;Selecting by group.&#39;)
            else:
                print(&#39;Group is invalid; Specified specimens do not exist&#39;)
         
        else:
            # 2) Otherwise first try if indices to self.folders
            try:
                sel_indices = [int(i) for i in user_input.split(&#39;,&#39;)]
                selections = [self.filt_folders[i] for i in sel_indices]
            except IndexError:
                print(&#39;One of the given numbers goes over limits, try again.&#39;)
            
            # 3) Next try if specifying by specimen names
            except ValueError:
                print(&#39;Not number values given, trying with base names&#39;)
                
                sel_keys = [os.path.basename(x) for x in user_input.split(&#39;,&#39;)]
                selections = [folder for folder in self.folders if os.path.basename(folder) in sel_keys]
                
                if len(selections) == len(sel_keys):
                    print(&#39;Worked.&#39;)
                else:
                    print(&#39;Did not work, try again.&#39;)
        
        try:
            selections
        except:
            ValueError(&#34;parse_specimens unable to process {}&#34;.format(user_input))

        return selections
        

    def ask_user(self, startswith=&#39;&#39;, endswith=&#39;&#39;, contains=&#39;&#39;):
        &#39;&#39;&#39;
        In terminal, ask user to select a Droso folder and can perform simple
        filtering of folders based on folder name.

        INPUT ARGUMENTS         DESCRIPTION
        startswith              Folder&#39;s name has to start with this string
        endswith                Folder&#39;s name has to have this string in the end
        contains                Folder&#39;s name has to have this string somewhere

        RETURNS                 A list of directories (strings) that the user selected?
        &#39;&#39;&#39;
        available_commands = [&#39;new_group&#39;, &#39;list_groups&#39;, ]

        # Filtering of folders based on their name: startswith, endswith, and contains
        self.filt_folders = [f for f in self.folders if
                os.path.split(f)[1].startswith(startswith) and os.path.split(f)[1].endswith(endswith) and contains in os.path.split(f)[1]]
        
        folders = self.filt_folders

        print(&#39;\nSelect a Droso folder (give either number or drosoname, to select many comma split)&#39;)
        for i, folder in enumerate(folders):
            print(&#34;  {}) {}&#34;.format(i, folder))
        
        print(&#39;Type help for additional commands&#39;)

        while True:
            user_input = input(&#39;&gt;&gt; &#39;)

            # 
            splitted = user_input.split(&#39; &#39;)
            if splitted[0] == &#39;help&#39;:
                print(&#39;Following commands are avaible&#39;)
                for cmd in available_commands:
                    print(&#39;  &#39;+cmd)
            elif splitted[0] == &#39;new_group&#39;:
                self.groups.new_group(*splitted[1:])
            elif splitted[0] == &#39;list_groups&#39;:
                print(self.groups.get_groups())
            else:
                try:
                    selections = self.parse_specimens(user_input)
                    break
                except ValueError:
                    pass

        print(&#39;\nSelected {}\n&#39;.format(selections))
        
        self.groups.save_groups()
    
        return selections</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="gonioanalysis.droso.DrosoSelect.ask_user"><code class="name flex">
<span>def <span class="ident">ask_user</span></span>(<span>self, startswith='', endswith='', contains='')</span>
</code></dt>
<dd>
<div class="desc"><p>In terminal, ask user to select a Droso folder and can perform simple
filtering of folders based on folder name.</p>
<p>INPUT ARGUMENTS
DESCRIPTION
startswith
Folder's name has to start with this string
endswith
Folder's name has to have this string in the end
contains
Folder's name has to have this string somewhere</p>
<p>RETURNS
A list of directories (strings) that the user selected?</p></div>
</dd>
<dt id="gonioanalysis.droso.DrosoSelect.parse_specimens"><code class="name flex">
<span>def <span class="ident">parse_specimens</span></span>(<span>self, user_input)</span>
</code></dt>
<dd>
<div class="desc"><p>Parse user input to get manalyser names.</p>
<h2 id="arguments">Arguments</h2>
<dl>
<dt><strong><code>*user_input</code></strong> :&ensp;<code>string</code></dt>
<dd>Comma separated list of specimen names or indices of self.folders,
or a group name.</dd>
</dl>
<p>Raises ValueError if unable to parse.</p></div>
</dd>
</dl>
</dd>
<dt id="gonioanalysis.droso.SpecimenGroups"><code class="flex name class">
<span>class <span class="ident">SpecimenGroups</span></span>
</code></dt>
<dd>
<div class="desc"><p>Managing specimens into groups.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SpecimenGroups:
    &#39;&#39;&#39;
    Managing specimens into groups. 
    &#39;&#39;&#39;

    def __init__(self):
        self.groups = {}
        
        self.load_groups()

    def load_groups(self):
        try:
            with open(os.path.join(GONIODIR, &#39;specimen_groups.txt&#39;), &#39;r&#39;) as fp:
                self.groups = json.load(fp)
        except FileNotFoundError:
            print(&#39;No specimen groups&#39;)

    def save_groups(self):
        &#39;&#39;&#39;
        Save groups but only if groups has some members (does not save an empty dict)
        &#39;&#39;&#39;
        if len(self.groups.keys()) &gt;= 0:
            with open(os.path.join(GONIODIR, &#39;specimen_groups.txt&#39;), &#39;w&#39;) as fp:
                json.dump(self.groups, fp)

      
    def new_group(self, group_name, *specimens):
        self.groups[group_name] = [*specimens]
    

    def get_groups(self):
        &#39;&#39;&#39;
        Returns the groups dictionary
        &#39;&#39;&#39;
        return self.groups

    def get_specimens(self, group_name):
        return self.groups[group_name]</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="gonioanalysis.droso.SpecimenGroups.get_groups"><code class="name flex">
<span>def <span class="ident">get_groups</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the groups dictionary</p></div>
</dd>
<dt id="gonioanalysis.droso.SpecimenGroups.get_specimens"><code class="name flex">
<span>def <span class="ident">get_specimens</span></span>(<span>self, group_name)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="gonioanalysis.droso.SpecimenGroups.load_groups"><code class="name flex">
<span>def <span class="ident">load_groups</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="gonioanalysis.droso.SpecimenGroups.new_group"><code class="name flex">
<span>def <span class="ident">new_group</span></span>(<span>self, group_name, *specimens)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="gonioanalysis.droso.SpecimenGroups.save_groups"><code class="name flex">
<span>def <span class="ident">save_groups</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Save groups but only if groups has some members (does not save an empty dict)</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<a href='../index.html'><- Back to All Docs</a><br>
<a href="javascript:history.back()"><- Back one page</a>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="gonioanalysis" href="index.html">gonioanalysis</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="gonioanalysis.droso.simple_select" href="#gonioanalysis.droso.simple_select">simple_select</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="gonioanalysis.droso.DrosoSelect" href="#gonioanalysis.droso.DrosoSelect">DrosoSelect</a></code></h4>
<ul class="">
<li><code><a title="gonioanalysis.droso.DrosoSelect.ask_user" href="#gonioanalysis.droso.DrosoSelect.ask_user">ask_user</a></code></li>
<li><code><a title="gonioanalysis.droso.DrosoSelect.parse_specimens" href="#gonioanalysis.droso.DrosoSelect.parse_specimens">parse_specimens</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="gonioanalysis.droso.SpecimenGroups" href="#gonioanalysis.droso.SpecimenGroups">SpecimenGroups</a></code></h4>
<ul class="">
<li><code><a title="gonioanalysis.droso.SpecimenGroups.get_groups" href="#gonioanalysis.droso.SpecimenGroups.get_groups">get_groups</a></code></li>
<li><code><a title="gonioanalysis.droso.SpecimenGroups.get_specimens" href="#gonioanalysis.droso.SpecimenGroups.get_specimens">get_specimens</a></code></li>
<li><code><a title="gonioanalysis.droso.SpecimenGroups.load_groups" href="#gonioanalysis.droso.SpecimenGroups.load_groups">load_groups</a></code></li>
<li><code><a title="gonioanalysis.droso.SpecimenGroups.new_group" href="#gonioanalysis.droso.SpecimenGroups.new_group">new_group</a></code></li>
<li><code><a title="gonioanalysis.droso.SpecimenGroups.save_groups" href="#gonioanalysis.droso.SpecimenGroups.save_groups">save_groups</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.1</a>.</p>
</footer>
</body>
</html>
