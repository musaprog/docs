<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.1">
<title>gonioanalysis.tkgui.core API documentation</title>
<meta name="description" content="">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>gonioanalysis.tkgui.core</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="gonioanalysis.tkgui.core.Core"><code class="flex name class">
<span>class <span class="ident">Core</span></span>
</code></dt>
<dd>
<div class="desc"><p>Tkinter independent functions, reusable for other GUI implementations.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>data_directory</code></strong> :&ensp;<code>list</code> of <code>strings</code></dt>
<dd>Current data directories</dd>
<dt><strong><code>current_specimen</code></strong> :&ensp;<code>string</code></dt>
<dd>Name of the current specimen</dd>
<dt><strong><code>analyser</code></strong> :&ensp;<code>object</code></dt>
<dd>MAnalyser (or OAnalsyer) object of the current specimen</dd>
<dt><strong><code>selected_recording</code></strong> :&ensp;<code>string</code></dt>
<dd>Selected recording name (image_folder)</dd>
<dt><strong><code>analyser_class</code></strong> :&ensp;<code>class</code></dt>
<dd>Class of the new analysers to create (MAnalyser or OAnalyser)</dd>
<dt><strong><code>analyser_classes</code></strong> :&ensp;<code>list</code> of <code>classes</code></dt>
<dd>List of available analyser classes for reference</dd>
<dt><strong><code>active_analysis</code></strong> :&ensp;<code>string</code> or <code>None</code></dt>
<dd>Name of the active analysis</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Core:
    &#39;&#39;&#39;
    Tkinter independent functions, reusable for other GUI implementations.
    
    Attributes
    ----------
    data_directory : list of strings
        Current data directories
    current_specimen : string
        Name of the current specimen
    analyser : object
        MAnalyser (or OAnalsyer) object of the current specimen
    selected_recording : string
        Selected recording name (image_folder)
    analyser_class : class
        Class of the new analysers to create (MAnalyser or OAnalyser)
    analyser_classes: list of classes
        List of available analyser classes for reference
    active_analysis : string or None
        Name of the active analysis
    &#39;&#39;&#39;

    def __init__(self):
        
        self.data_directory = []
        self.current_specimen = None
        self.analyser = None
        self.selected_recording = None
        
        self.analyser_class = analyser_classes[&#39;motion&#39;]
        self.analyser_classes = list(analyser_classes.values())
        
        self.active_analysis = None

        self._folders = {}

        self.groups = SpecimenGroups()


    def set_data_directory(self, data_directory):
        &#39;&#39;&#39;
        Update Core&#39;s knowledge about the currently selected data_directory.

        Arguments
        ---------
        data_directory : list of strings
            List of paths to the data
        &#39;&#39;&#39;
        self.data_directory = data_directory
        
        self._folders = {}
        for data_directory in self.data_directory:
            self._folders[data_directory] = os.listdir(data_directory)


    def set_current_specimen(self, specimen_name):
        &#39;&#39;&#39;
        Update Core&#39;s knowledge about the currently selected specimen.
        &#39;&#39;&#39;
        self.current_specimen = specimen_name
        self.analyser = self.get_manalyser(specimen_name)

    
    def set_selected_recording(self, selected_recording):
        self.selected_recording = selected_recording
    

    def set_analyser_class(self, class_name):
        index = [i for i, ac in enumerate(self.analyser_classes) if ac.__name__ == class_name]
        self.analyser_class = self.analyser_classes[index[0]]
        
        if self.data_directory:
            self.update_gui(changed_specimens=True)


    def list_specimens(self, with_rois=None, with_movements=None, with_correction=None):
        &#39;&#39;&#39;
        List specimens in the data directory. May contain bad folders also (no check for contents)

        With the following keyword arguments one select only the specimens fulfilling the conditions
        by setting the keyword argument either to True (has to fulfill condition), False (negative)
        or to None (the condition is not considered)

            with_rois           Specimens with ROIs selected
            with_movements      Specimens with movements measured
            with_correction     Specimens with antenna_level (zero level) correction
        
        For example, if you want the specimens with movements but without antenna_level corrections
        and you won&#39;t care about ROIs, set
            with_rois=None, with_movements=True, with_correction=False

        &#39;&#39;&#39;
        specimens = []
        for data_directory in self.data_directory:
            specimens.extend( [fn for fn in os.listdir(data_directory) if os.path.isdir(os.path.join(data_directory, fn))] )
        
        if with_rois is not None:
            specimens = [specimen for specimen in specimens if self.get_manalyser(specimen, no_data_load=True).are_rois_selected() == with_rois]
        
        if with_movements is not None:
            specimens = [specimen for specimen in specimens if self.get_manalyser(specimen, no_data_load=True).is_measured() == with_movements]
        
        if with_correction is not None:
            specimens = [specimen for specimen in specimens if self.get_manalyser(specimen, no_data_load=True).get_antenna_level_correction() is not False]

        return sorted(specimens)
    

    def get_specimen_fullpath(self, specimen_name=None):
        &#39;&#39;&#39;
        Returns the full path of a specimen (datadir + specimen_patch)
        
        Arguments
        ---------
        specimen_namse : string or None
            If None use self.current_specimen
        &#39;&#39;&#39;
        if specimen_name is None:
            specimen_name = self.current_specimen

        for directory in self.data_directory:
            if specimen_name in self._folders[directory]:
                return os.path.join(directory, specimen_name)

        raise ValueError(&#34;no specimen with name {}&#34;.format(specimen_name))


    def _configure_analyser(self, analyser):
        if self.active_analysis:
            analyser.active_analysis = self.active_analysis
        return analyser


    def get_manalyser(self, specimen_name, **kwargs):
        &#39;&#39;&#39;
        Gets manalyser for the specimen specified by the given name.
        &#39;&#39;&#39;
        for directory in self.data_directory:
            if specimen_name in self._folders[directory]:
                break

        analyser = self.analyser_class(directory, specimen_name, **kwargs)

        return self._configure_analyser(analyser)
    

    def get_manalysers(self, specimen_names, **kwargs):
        &#39;&#39;&#39;
        Like get_manalyser but returns a list of analyser objects and also
        checks for specimen groups if a specimen cannot be found.
        &#39;&#39;&#39;
        analysers = []
        for name in specimen_names:
            try:
                ans = [self.get_manalyser(name, **kwargs)]
            except FileNotFoundError:
                ans = [self.get_manalyser(n, **kwargs) for n in self.groups.groups.get(name, [])]
                
                # Try again and load
                if ans is []:
                    self.groups.load_groups()
                    ans = [self.get_manalyser(n, **kwargs) for n in self.groups.groups.get(name, [])]
            
            if ans is []:
                raise FileNotFoundError(&#39;Cannot find specimen {}&#39;.format(name))
            
            for an in ans:
                analysers.append( self._configure_analyser(an) )

        return analysers


    def adm_subprocess(self, specimens, terminal_args, open_terminal=False):
        &#39;&#39;&#39;
        Invokes drosom/terminal.py
        
        Arguments
        ---------
        specimens : list of string
            List of specimen names or &#39;current&#39;
        terminal_args : string
            Agruments passed to the plotter
        open_terminal : bool
            If true open in a cmd window (on Windows) or lxterm (on Linux)
        &#39;&#39;&#39;
        
        # 1) Find python executable and wrap the filename by quation marks if spaces present
        python = sys.executable
        if &#39; &#39; in python:
            python = &#39;&#34;&#39; + python + &#39;&#34;&#39;

       
        # 2) Find the full path to the adm Python file in the gonio root
        pyfile = os.path.join(CODE_ROOTDIR, &#39;drosom/terminal.py&#39;)
        
        # Check for spaces in the filename. If there are spaces in the filename,
        # we have to encapsulate the filename by quation marks
        if &#39; &#39; in pyfile:
            pyfile = &#39;&#34;&#39; + pyfile + &#39;&#34;&#39;

        # 3) Get the specimen directoires (full paths separated by space)
        if specimens == &#39;current&#39;:
            specimen_names = self.analyser.folder
        else:
            specimen_names = &#39;:&#39;.join(specimens)
            if not &#39;:&#39; in specimen_names:
                specimen_names += &#39;:&#39;
        
        if self.active_analysis not in [&#39;default&#39;, &#39;&#39;, None]:
            terminal_args += &#39; --active-analysis &#39;+ self.active_analysis

        arguments = &#39;-D &#34;{}&#34; -S &#34;{}&#34; {}&#39;.format(&#39; &#39;.join(self.data_directory), specimen_names, terminal_args)
        
        # Add the type option matching the current analyser
        for key, value in analyser_classes.items():
            if value is self.analyser_class:
                arguments = f&#39;--type {key} {arguments}&#39;

        command = &#39;{} {} {} &amp;&#39;.format(python, pyfile, arguments)
        
        if open_terminal:
            if platform.system() == &#39;Linux&#39;:
                command = &#39;lxterm -e &#39; + command
            elif platform.system() == &#39;Windows&#39;:
                command = &#39;start /wait &#39; + command
            else:
                raise OSError(&#39;Operating system not supported by gonio?&#39;)

        print(command)
        
        subprocess.run(command, shell=True)


    def update_gui(self, changed_specimens=False):
        raise ValueError(&#34;GUI should overload update_gui method in Core core.py&#34;)</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="gonioanalysis.tkgui.core.Core.adm_subprocess"><code class="name flex">
<span>def <span class="ident">adm_subprocess</span></span>(<span>self, specimens, terminal_args, open_terminal=False)</span>
</code></dt>
<dd>
<div class="desc"><p>Invokes drosom/terminal.py</p>
<h2 id="arguments">Arguments</h2>
<dl>
<dt><strong><code>specimens</code></strong> :&ensp;<code>list</code> of <code>string</code></dt>
<dd>List of specimen names or 'current'</dd>
<dt><strong><code>terminal_args</code></strong> :&ensp;<code>string</code></dt>
<dd>Agruments passed to the plotter</dd>
<dt><strong><code>open_terminal</code></strong> :&ensp;<code>bool</code></dt>
<dd>If true open in a cmd window (on Windows) or lxterm (on Linux)</dd>
</dl></div>
</dd>
<dt id="gonioanalysis.tkgui.core.Core.get_manalyser"><code class="name flex">
<span>def <span class="ident">get_manalyser</span></span>(<span>self, specimen_name, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Gets manalyser for the specimen specified by the given name.</p></div>
</dd>
<dt id="gonioanalysis.tkgui.core.Core.get_manalysers"><code class="name flex">
<span>def <span class="ident">get_manalysers</span></span>(<span>self, specimen_names, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Like get_manalyser but returns a list of analyser objects and also
checks for specimen groups if a specimen cannot be found.</p></div>
</dd>
<dt id="gonioanalysis.tkgui.core.Core.get_specimen_fullpath"><code class="name flex">
<span>def <span class="ident">get_specimen_fullpath</span></span>(<span>self, specimen_name=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the full path of a specimen (datadir + specimen_patch)</p>
<h2 id="arguments">Arguments</h2>
<dl>
<dt><strong><code>specimen_namse</code></strong> :&ensp;<code>string</code> or <code>None</code></dt>
<dd>If None use self.current_specimen</dd>
</dl></div>
</dd>
<dt id="gonioanalysis.tkgui.core.Core.list_specimens"><code class="name flex">
<span>def <span class="ident">list_specimens</span></span>(<span>self, with_rois=None, with_movements=None, with_correction=None)</span>
</code></dt>
<dd>
<div class="desc"><p>List specimens in the data directory. May contain bad folders also (no check for contents)</p>
<p>With the following keyword arguments one select only the specimens fulfilling the conditions
by setting the keyword argument either to True (has to fulfill condition), False (negative)
or to None (the condition is not considered)</p>
<pre><code>with_rois           Specimens with ROIs selected
with_movements      Specimens with movements measured
with_correction     Specimens with antenna_level (zero level) correction
</code></pre>
<p>For example, if you want the specimens with movements but without antenna_level corrections
and you won't care about ROIs, set
with_rois=None, with_movements=True, with_correction=False</p></div>
</dd>
<dt id="gonioanalysis.tkgui.core.Core.set_analyser_class"><code class="name flex">
<span>def <span class="ident">set_analyser_class</span></span>(<span>self, class_name)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="gonioanalysis.tkgui.core.Core.set_current_specimen"><code class="name flex">
<span>def <span class="ident">set_current_specimen</span></span>(<span>self, specimen_name)</span>
</code></dt>
<dd>
<div class="desc"><p>Update Core's knowledge about the currently selected specimen.</p></div>
</dd>
<dt id="gonioanalysis.tkgui.core.Core.set_data_directory"><code class="name flex">
<span>def <span class="ident">set_data_directory</span></span>(<span>self, data_directory)</span>
</code></dt>
<dd>
<div class="desc"><p>Update Core's knowledge about the currently selected data_directory.</p>
<h2 id="arguments">Arguments</h2>
<dl>
<dt><strong><code>data_directory</code></strong> :&ensp;<code>list</code> of <code>strings</code></dt>
<dd>List of paths to the data</dd>
</dl></div>
</dd>
<dt id="gonioanalysis.tkgui.core.Core.set_selected_recording"><code class="name flex">
<span>def <span class="ident">set_selected_recording</span></span>(<span>self, selected_recording)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="gonioanalysis.tkgui.core.Core.update_gui"><code class="name flex">
<span>def <span class="ident">update_gui</span></span>(<span>self, changed_specimens=False)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<a href='../index.html'><- Back to All Docs</a><br>
<a href="javascript:history.back()"><- Back one page</a>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="gonioanalysis.tkgui" href="index.html">gonioanalysis.tkgui</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="gonioanalysis.tkgui.core.Core" href="#gonioanalysis.tkgui.core.Core">Core</a></code></h4>
<ul class="">
<li><code><a title="gonioanalysis.tkgui.core.Core.adm_subprocess" href="#gonioanalysis.tkgui.core.Core.adm_subprocess">adm_subprocess</a></code></li>
<li><code><a title="gonioanalysis.tkgui.core.Core.get_manalyser" href="#gonioanalysis.tkgui.core.Core.get_manalyser">get_manalyser</a></code></li>
<li><code><a title="gonioanalysis.tkgui.core.Core.get_manalysers" href="#gonioanalysis.tkgui.core.Core.get_manalysers">get_manalysers</a></code></li>
<li><code><a title="gonioanalysis.tkgui.core.Core.get_specimen_fullpath" href="#gonioanalysis.tkgui.core.Core.get_specimen_fullpath">get_specimen_fullpath</a></code></li>
<li><code><a title="gonioanalysis.tkgui.core.Core.list_specimens" href="#gonioanalysis.tkgui.core.Core.list_specimens">list_specimens</a></code></li>
<li><code><a title="gonioanalysis.tkgui.core.Core.set_analyser_class" href="#gonioanalysis.tkgui.core.Core.set_analyser_class">set_analyser_class</a></code></li>
<li><code><a title="gonioanalysis.tkgui.core.Core.set_current_specimen" href="#gonioanalysis.tkgui.core.Core.set_current_specimen">set_current_specimen</a></code></li>
<li><code><a title="gonioanalysis.tkgui.core.Core.set_data_directory" href="#gonioanalysis.tkgui.core.Core.set_data_directory">set_data_directory</a></code></li>
<li><code><a title="gonioanalysis.tkgui.core.Core.set_selected_recording" href="#gonioanalysis.tkgui.core.Core.set_selected_recording">set_selected_recording</a></code></li>
<li><code><a title="gonioanalysis.tkgui.core.Core.update_gui" href="#gonioanalysis.tkgui.core.Core.update_gui">update_gui</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.1</a>.</p>
</footer>
</body>
</html>
